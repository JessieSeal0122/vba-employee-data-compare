# vba-employee-data-compare

A VBA macro that compares two personnel data sheets in Excel, highlights mismatched fields, and generates a clear visual summary for auditing purposes.

---

## 🧰 Features

- **Duplicate detection**:  
  Checks for duplicate Employee IDs in both "Raw data 1" and "Raw data 2". If duplicates are found, they are highlighted in red and the macro halts.
  
- **Data comparison**:  
  If no duplicates exist, the macro proceeds to compare specified fields across both sheets by Employee ID.

- **Results output**:  
  Mismatched records are written to a "Results" sheet. The sheet is cleared if it already exists.

- **Field-level highlighting**:  
  Yellow fill is used to mark differing fields side-by-side for easy review.

- **User feedback**:  
  - If differences exist: shows “比對完成！結果已儲存到 'Results' 工作表。”  
  - If no differences: shows “無變更資料”

---

## 📁 Workbook Structure

- `Raw data 1` and `Raw data 2`: Input worksheets for comparison
- `Results`: Output sheet generated by the macro

---

## 🔁 Fields Compared

- Department  
- Cost Center  
- Company Code  
- Location  

---

## 📥 To import the macro:

1. Open Excel and press `Alt + F11` to open the VBA editor.
2. Go to `File > Import File...` and select `EmployeeDataComparer.bas`.
3. Run `EmployeeDataComparer` from the macro list.

---

## ▶️ How to Use

1. Place Raw data 1 and Raw data 2 in the same workbook.
2. Press Alt + F11 to open the VBA editor.
3. Insert a module and paste the ILoveNaiHsinLin macro.
4. Run the macro.
5. If there are duplicate Employee IDs, the macro stops and highlights them in red.
   If no duplicates exist, it continues with comparison and creates/updates the Results sheet.

---

## 🖼 Output Highlighting

- 🔴 Red: Duplicate Employee ID  
- 🟡 Yellow: Field mismatch  
- 🎨 Colored headers for comparison clarity

---

## 📌 Notes

- No external dependencies required  
- Can be extended to compare more fields or support fuzzy matching

---

## 🧩 License

This project is licensed under the MIT License.
